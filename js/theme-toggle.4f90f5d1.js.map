{"version":3,"file":"js/theme-toggle.4f90f5d1.js","mappings":"6sBAGA,WACE,aAEA,IAAMA,EAAc,iBAIdC,EAAY,WAIf,O,EAHD,SAAAA,K,4FAAcC,CAAA,KAAAD,GACZE,KAAKC,aAAe,KACpBD,KAAKE,MACP,G,EAAC,EAAAC,IAAA,OAAAC,MAED,WAEE,IAAMC,EAAaL,KAAKM,gBACJN,KAAKO,iBACzBP,KAAKC,aAAeI,GAAc,OAGlCL,KAAKQ,WAAWR,KAAKC,cAGrBD,KAAKS,mBAGLT,KAAKU,sBACP,GAAC,CAAAP,IAAA,gBAAAC,MAED,WACE,IACE,OAAOO,aAAaC,QAAQf,EAC9B,CAAE,MAAOgB,GAEP,OAAO,IACT,CACF,GAAC,CAAAV,IAAA,YAAAC,MAED,SAAUU,GACR,IACEH,aAAaI,QAAQlB,EAAaiB,EACpC,CAAE,MAAOD,GAET,CACF,GAAC,CAAAV,IAAA,iBAAAC,MAED,WACE,OAAIY,OAAOC,YAAcD,OAAOC,WAAW,gCAAgCC,QAClE,OAEF,OACT,GAAC,CAAAf,IAAA,oBAAAC,MAED,SAAkBU,GAChB,MAAc,SAAVA,EACKd,KAAKO,iBAEPO,CACT,GAAC,CAAAX,IAAA,aAAAC,MAED,SAAWU,GACT,IAAMK,EAAiBnB,KAAKoB,kBAAkBN,GAC9CO,SAASC,gBAAgBC,aAAa,aAAcJ,GAGpD,IAIiCK,EAExBC,EANHC,EAAYL,SAASM,cAAc,4CACnCC,EAAWP,SAASM,cAAc,2CAEpCD,GAAaE,IACQ,SAAnBT,EACgD,QAAlDK,EAAAH,SAASM,cAAc,mCAA2B,IAAAH,GAAlDA,EAAoDD,aAAa,UAAW,WAE1B,QAAlDE,EAAAJ,SAASM,cAAc,mCAA2B,IAAAF,GAAlDA,EAAoDF,aAAa,UAAW,WAGlF,GAAC,CAAApB,IAAA,cAAAC,MAED,WAEE,IAAMyB,EAAS,CAAC,OAAQ,QAAS,QAC3BC,EAAeD,EAAOE,QAAQ/B,KAAKC,cAEnC+B,EAAYH,GADCC,EAAe,GAAKD,EAAOI,QAG9CjC,KAAKC,aAAe+B,EACpBhC,KAAKkC,UAAUF,GACfhC,KAAKQ,WAAWwB,GAGhBhB,OAAOmB,cAAc,IAAIC,YAAY,cAAe,CAClDC,OAAQ,CACNvB,MAAOkB,EACPb,eAAgBnB,KAAKoB,kBAAkBY,MAG7C,GAAC,CAAA7B,IAAA,mBAAAC,MAED,WAAmB,IAAAkC,EAAA,KACjB,GAAKtB,OAAOC,WAAZ,CAEA,IAAMsB,EAAavB,OAAOC,WAAW,gCAE/BuB,EAAU,SAAC3B,GACW,SAAtByB,EAAKrC,cACPqC,EAAK9B,WAAW,OAEpB,EAGI+B,EAAWE,iBACbF,EAAWE,iBAAiB,SAAUD,GAG/BD,EAAWG,aAClBH,EAAWG,YAAYF,EAhBK,CAkBhC,GAAC,CAAArC,IAAA,uBAAAC,MAED,WAAuB,IAAAuC,EAAA,KACfC,EAAevB,SAASwB,eAnHV,eAoHhBD,GACFA,EAAaH,iBAAiB,QAAS,WACrCE,EAAKG,aACP,EAEJ,M,yFAAC,CAtHe,GA0HU,YAAxBzB,SAAS0B,WACX1B,SAASoB,iBAAiB,mBAAoB,WAC5C,IAAI3C,CACN,GAEA,IAAIA,CAEP,CAxID,E","sources":["webpack://hexo-theme-papermod/./source-src/js/theme-toggle.js"],"sourcesContent":["// Theme toggle functionality\n// This file is also inlined in head.ejs to prevent FOUC\n\n(function() {\n  'use strict';\n\n  const STORAGE_KEY = 'papermod-theme';\n  const THEME_TOGGLE_ID = 'themeToggle';\n\n  // Theme management class\n  class ThemeManager {\n    constructor() {\n      this.currentTheme = null;\n      this.init();\n    }\n\n    init() {\n      // Get saved theme or use system preference\n      const savedTheme = this.getSavedTheme();\n      const systemTheme = this.getSystemTheme();\n      this.currentTheme = savedTheme || 'auto';\n\n      // Apply theme\n      this.applyTheme(this.currentTheme);\n\n      // Listen for system theme changes\n      this.watchSystemTheme();\n\n      // Attach event listener to toggle button\n      this.attachToggleListener();\n    }\n\n    getSavedTheme() {\n      try {\n        return localStorage.getItem(STORAGE_KEY);\n      } catch (e) {\n        console.warn('localStorage not available:', e);\n        return null;\n      }\n    }\n\n    saveTheme(theme) {\n      try {\n        localStorage.setItem(STORAGE_KEY, theme);\n      } catch (e) {\n        console.warn('Could not save theme:', e);\n      }\n    }\n\n    getSystemTheme() {\n      if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {\n        return 'dark';\n      }\n      return 'light';\n    }\n\n    getEffectiveTheme(theme) {\n      if (theme === 'auto') {\n        return this.getSystemTheme();\n      }\n      return theme;\n    }\n\n    applyTheme(theme) {\n      const effectiveTheme = this.getEffectiveTheme(theme);\n      document.documentElement.setAttribute('data-theme', effectiveTheme);\n\n      // Update meta theme-color\n      const lightMeta = document.querySelector('meta[name=\"theme-color\"][media*=\"light\"]');\n      const darkMeta = document.querySelector('meta[name=\"theme-color\"][media*=\"dark\"]');\n\n      if (lightMeta && darkMeta) {\n        if (effectiveTheme === 'dark') {\n          document.querySelector('meta[name=\"theme-color\"]')?.setAttribute('content', '#1a1a1a');\n        } else {\n          document.querySelector('meta[name=\"theme-color\"]')?.setAttribute('content', '#ffffff');\n        }\n      }\n    }\n\n    toggleTheme() {\n      // Cycle through: auto -> light -> dark -> auto\n      const themes = ['auto', 'light', 'dark'];\n      const currentIndex = themes.indexOf(this.currentTheme);\n      const nextIndex = (currentIndex + 1) % themes.length;\n      const nextTheme = themes[nextIndex];\n\n      this.currentTheme = nextTheme;\n      this.saveTheme(nextTheme);\n      this.applyTheme(nextTheme);\n\n      // Emit custom event for other components\n      window.dispatchEvent(new CustomEvent('themechange', {\n        detail: {\n          theme: nextTheme,\n          effectiveTheme: this.getEffectiveTheme(nextTheme)\n        }\n      }));\n    }\n\n    watchSystemTheme() {\n      if (!window.matchMedia) return;\n\n      const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\n\n      const handler = (e) => {\n        if (this.currentTheme === 'auto') {\n          this.applyTheme('auto');\n        }\n      };\n\n      // Modern browsers\n      if (mediaQuery.addEventListener) {\n        mediaQuery.addEventListener('change', handler);\n      }\n      // Legacy browsers\n      else if (mediaQuery.addListener) {\n        mediaQuery.addListener(handler);\n      }\n    }\n\n    attachToggleListener() {\n      const toggleButton = document.getElementById(THEME_TOGGLE_ID);\n      if (toggleButton) {\n        toggleButton.addEventListener('click', () => {\n          this.toggleTheme();\n        });\n      }\n    }\n  }\n\n  // Initialize theme manager when DOM is ready\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', () => {\n      new ThemeManager();\n    });\n  } else {\n    new ThemeManager();\n  }\n})();\n"],"names":["STORAGE_KEY","ThemeManager","_classCallCheck","this","currentTheme","init","key","value","savedTheme","getSavedTheme","getSystemTheme","applyTheme","watchSystemTheme","attachToggleListener","localStorage","getItem","e","theme","setItem","window","matchMedia","matches","effectiveTheme","getEffectiveTheme","document","documentElement","setAttribute","_document$querySelect","_document$querySelect2","lightMeta","querySelector","darkMeta","themes","currentIndex","indexOf","nextTheme","length","saveTheme","dispatchEvent","CustomEvent","detail","_this","mediaQuery","handler","addEventListener","addListener","_this2","toggleButton","getElementById","toggleTheme","readyState"],"ignoreList":[],"sourceRoot":""}